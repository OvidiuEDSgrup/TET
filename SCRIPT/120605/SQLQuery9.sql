SELECT (select val_alfanumerica as nume from par where tip_parametru='GE' and parametru='NUME') as C001, '19%' as C002, max(terti.denumire) as C003, (select max(descriere) from infotert where subunitate=max(pozdoc.subunitate) and tert=max(pozdoc.tert) and identificator=max(substring(pozdoc.numar_DVI,14,5))) as C004, (select val_alfanumerica from par where tip_parametru = 'GE' and parametru = 'ORDREG') as C005, (select max(banca3) from infotert where subunitate=max(pozdoc.subunitate) and tert=max(pozdoc.tert) and identificator='') as C006, max(terti.judet) as C007, (select val_alfanumerica from par where tip_parametru='GE' and parametru = 'JUDET') as C008, max(pozdoc.factura) as C009, max(convert(CHAR(10),pozdoc.data,103)) as C010, (select val_alfanumerica as cif from par where tip_parametru = 'GE' and parametru = 'CODFISC') as C011, (select val_alfanumerica from par where tip_parametru='GE' and parametru = 'CONTBC') as C012, max(terti.cont_in_banca) as C013, max(terti.cod_fiscal) as C014, (select val_alfanumerica from par where tip_parametru='GE' and parametru = 'BANCA') as C015, max(terti.banca) as C016, max(pozdoc.numar) as C017, max(terti.adresa) as C018, (select val_alfanumerica from par where tip_parametru='GE' and parametru = 'ADRESA') as C019, convert(char(15),convert(money,round(sum(pozdoc.cantitate*pozdoc.pret_vanzare),2)),1) as C020, (case when max(pozdoc.barcod)='' or 1=0 then max(nomencl.um) else max(nomencl.um_1) end) as C021, convert(char(13),convert(money,round(sum(pozdoc.cantitate*pozdoc.pret_vanzare*pozdoc.cota_tva/100),2)),1) as C022, replicate(' ',15-len(rtrim(convert(char(15),convert(decimal(15,5),max(pozdoc.pret_vanzare)),1))))+rtrim(convert(char(15),convert(decimal(15,5),max(pozdoc.pret_vanzare)),1)) as C023, row_number() OVER(ORDER BY pozdoc.cod) as C024, (case when max(nomencl.tip)='F' then (select max(denumire) from mfix where subunitate<>'DENS' and numar_de_inventar=max(pozdoc.cod_intrare)) when max(pozdoc.barcod)='' or 1=1 then max(nomencl.denumire) else (select max(nomspec.denumire) from nomspec where max(pozdoc.barcod)=nomspec.cod_special and pozdoc.cod=nomspec.cod and max(pozdoc.tert)=nomspec.tert) end) as C025, left(convert(char(16),convert(money,round(sum(pozdoc.cantitate),3)),2),15) as C026, left(convert(char(16),convert(money,round(sum(pozdoc.cantitate)/(select max(nomspec.discount) from nomspec where  max(pozdoc.barcod)=nomspec.cod_special and pozdoc.cod=nomspec.cod and max(pozdoc.tert)=nomspec.tert),3)),2),15) as C027, (case when max(pozdoc.barcod)<>'' and 1=1 then left(convert(char(16),convert(money,round(max(pozdoc.pret_valuta)*(select max(nomspec.discount) from nomspec where  max(pozdoc.barcod)=nomspec.cod_special and pozdoc.cod=nomspec.cod and max(pozdoc.tert)=nomspec.tert),2),2),1),15) end) as C028, convert(char(15),convert(money,round((select sum(p.tva_deductibil) from pozdoc p, avnefac av where av.terminal=max(avnefac.terminal) and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1) as C029, convert(char(15),convert(money,round((select sum(round(p.cantitate*p.pret_vanzare,2)+p.tva_deductibil) from pozdoc p, avnefac av where av.terminal=max(avnefac.terminal) and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1) as C030, convert(char(15),convert(money,round((select sum(round(p.cantitate*p.pret_vanzare,2)) from pozdoc p, avnefac av where av.terminal=max(avnefac.terminal) and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1) as C031, (case when (select sum(p.discount)from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data)>0 then convert(char(15),convert(money,round((select sum(p.cantitate*p.pret_valuta)from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1)else '' end) as C032, max(anexafac.eliberat) as C033, left(max(anexafac.ora_expedierii),2)+':'+substring(max(anexafac.ora_expedierii),3,2) as C034, (select val_alfanumerica from par where tip_parametru='ID' and parametru=rtrim(host_id())+'N') as C035, (case when (select sum(p.discount)from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data)>0 then convert(char(15),convert(money,-1*round((select sum(p.cantitate*(p.pret_valuta-p.pret_vanzare))from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1)else '' end) as C036, max(anexafac.numele_delegatului) as C037, max(CONVERT(CHAR(10),anexafac.data_expedierii,103)) as C038, (select left(val_alfanumerica,13) from par where tip_parametru='ID' and parametru=rtrim(host_id())+'C') as C039, max(anexafac.numar_buletin) as C040, max(anexafac.seria_buletin) as C041, max(anexafac.mijloc_de_transport) as C042, (case when (select sum(p.discount)from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data)>0 then convert(char(15),convert(money,round((select sum(p.cantitate*p.pret_valuta*p.cota_tva/100)from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1)else '' end) as C043, (case when (select sum(p.discount)from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data)>0 then convert(char(15),convert(money,-round((select sum(p.cantitate*p.pret_valuta*p.cota_tva/100-p.tva_deductibil)from pozdoc p,avnefac av where av.terminal=max(avnefac.terminal)and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1)end) as C044, convert(char(15),convert(money,round((select sum(round(p.cantitate*p.accize_datorate,2)) from pozdoc p, avnefac av where av.terminal=max(avnefac.terminal) and p.subunitate=av.subunitate and p.tip=av.tip and p.numar=av.numar and av.data=p.data),2)),1) as C045,'' AS C046,'' AS C047,'' AS C048,'' AS C049,'' AS C050,'' AS C051,'' AS C052,'' AS C053,'' AS C054,'' AS C055,'' AS C056,'' AS C057,'' AS C058,'' AS C059,'' AS C060,'' AS C061,'' AS C062,'' AS C063,'' AS C064,'' AS C065,'' AS C066,'' AS C067,'' AS C068,'' AS C069,'' AS C070,'' AS C071,'' AS C072,'' AS C073,'' AS C074,'' AS C075,'' AS C076,'' AS C077,'' AS C078,'' AS C079,'' AS C080,'' AS C081,'' AS C082,'' AS C083,'' AS C084,'' AS C085,'' AS C086,'' AS C087,'' AS C088,'' AS C089,'' AS C090,'' AS C091,'' AS C092,'' AS C093,'' AS C094,'' AS C095,'' AS C096,'' AS C097,'' AS C098,'' AS C099,'' AS C100 FROM avnefac,pozdoc,terti,nomencl,anexafac WHERE pozdoc.subunitate=avnefac.subunitate and pozdoc.tip=avnefac.tip and pozdoc.numar=avnefac.numar and avnefac.data=pozdoc.data and pozdoc.cod=nomencl.cod and avnefac.subunitate=terti.subunitate and pozdoc.tert=terti.tert and anexafac.subunitate=avnefac.subunitate and anexafac.numar_factura=pozdoc.factura and avnefac.cod_gestiune='' AND AVNEFAC.TERMINAL='4080' GROUP BY pozdoc.cod, pozdoc.pret_vanzare, pozdoc.pret_valuta